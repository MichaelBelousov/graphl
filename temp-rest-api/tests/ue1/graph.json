{
  "imports": {
    "https://example.com/stuff/ue": [{ "ref": "do-once" }],
    "https://example.com/stuff/ue/physics": [{ "ref": "single-line-trace-by-channel" }],
    "file:///other": [{ "ref": "move-component-to" }]
  },
  "nodes": [
    {
      "type": "define-event",
      "defines": "tick",
      "outputs": [0]
    },
    {
      "type": "set!",
      "comment": "Update OverTime because because we are moving",
      "variable": "OverTime",
      "inputs": [0, 2],
      "outputs": [1]
    },
    {
      "type": "/",
      "inputs": [4, 3],
      "outputs": [2]
    },
    {
      "type": "GET_VAR",
      "variable": "Speed",
      "outputs": [3]
    },
    {
      "type": "vector-length",
      "inputs": [5],
      "outputs": [4]
    },
    {
      "type": "-",
      "inputs": [6, 7],
      "outputs": [5]
    },
    {
      "type": "get-actor-location",
      "inputs": [{ "value": "self" }],
      "outputs": [6]
    },
    {
      "type": "get-actor-location",
      "inputs": [9],
      "outputs": [7]
    },
    {
      "type": "GET_VAR",
      "variable": "CurrentSpawnPoint",
      "outputs": [9]
    },
    {
      "type": "delay",
      "inputs": [1, { "value": 0.1 }],
      "outputs": [10]
    },

    {
      "type": "switch",
      "inputs": [10, 11],
      "outputs": [12, 13, 14]
    },
    {
      "type": "GET_VAR",
      "variable": "DroneState",
      "outputs": [11]
    },

    {
      "type": "sequence",
      "comment": "first move to target and then check if something is near",
      "inputs": [12],
      "outputs": [15, 16]
    },

    {
      "type": "do-once",
      "inputs": [15, 63, {"value":false}],
      "outputs": [17]
    },
    {
      "type": "move-component-to",
      "comment": "Move Drone to TargetPoint",
      "inputs": [17, 40, null, 18, 20, 21, { "value": false }, { "value": false }, 22],
      "outputs": [1000]
    },
    {
      "type": "GET_VAR",
      "variable": "CapsuleComponent",
      "outputs": [18]
    },
    {
      "type": "GET_VAR",
      "variable": "CurrentSpawnPoint",
      "outputs": [19]
    },
    {
      "type": "get-actor-location",
      "inputs": [19],
      "outputs": [20]
    },
    {
      "type": "get-actor-rotation",
      "inputs": [{ "value": "self" }],
      "outputs": [21]
    },
    {
      "type": "GET_VAR",
      "variable": "OverTime",
      "outputs": [22]
    },

    {
      "type": "single-line-trace-by-channel",
      "comment": "Check if obstacle is forward to drone",
      "inputs": [16],
      "outputs": [23, 24, 25]
    },
    {
      "type": "BREAK_STRUCT",
      "inputs": [24],
      "outputs": [28, 29, 30, 31, 32, 33, 34, 35]
    },
    {
      "type": "if",
      "comment": "if we didn't hit anything - check again",
      "inputs": [23, 25],
      "outputs": [26, 27]
    },
    {
      "type": "cast",
      "comment": "if we hit AIMainPawn",
      "as": "AI_MainPawn",
      "inputs": [33],
      "outputs": [36, 37, 48]
    },
    {
      "type": "call",
      "comment": "We haven't hit anything - Check Again",
      "func": "custom-tick",
      "inputs": [37, { "value": "self" }],
      "outputs": [39]
    },
    {
      "type": "sequence",
      "comment": "We hit AIMain_Pawn! Stop the movement and then change state and CheckAgain",
      "inputs": [36],
      "outputs": [40, 41]
    },
    {
      "type": "set!",
      "comment": "Change State",
      "variable": "DroneState",
      "inputs": [41, {"value": "MoveUp"}],
      "outputs": [42]
    },
    {
      "type": "call",
      "comment": "Check Again",
      "func": "custom-tick",
      "inputs": [42],
      "outputs": [43]
    },

    {
      "type": "sequence",
      "comment": "First move Drone up and then check if we can move to Target again",
      "inputs": [13],
      "outputs": [44, 45]
    },

    {
      "type": "do-once",
      "comment": "We need to do this only once!",
      "inputs": [44, 64, {"value":false}],
      "outputs": [46]
    },
    {
      "type": "move-component-to",
      "comment": "Move up by 150 points",
      "inputs": [46, 62, null, 47, 48, 50, {"value":false}, {"value":false}, 51],
      "outputs": [1001]
    },
    {
      "type": "GET_VAR",
      "variable": "CapsuleComponent",
      "outputs": [47]
    },
    {
      "type": "+",
      "inputs": [49, {"value": [0.0, 0.0, 15.0]}],
      "outputs": [48]
    },
    {
      "type": "get-actor-location",
      "inputs": [{ "value": "self" }],
      "outputs": [49]
    },
    {
      "type": "get-actor-rotation",
      "inputs": [{ "value": "self" }],
      "outputs": [50]
    },
    {
      "type": "/",
      "inputs": [{ "value": 150 }, 52],
      "outputs": [51]
    },
    {
      "type": "GET_VAR",
      "variable": "Speed",
      "outputs": [52]
    },

    {
      "type": "single-line-trace-by-channel",
      "comment": "While moving up let's find if we can move again to Target",
      "inputs": [56, 57, {"value":"Visibility"}, {"value":false}, {"value":[]}, {"value":"None"}, {"value":true}],
      "outputs": [53, 54, 55]
    },
    {
      "type": "get-socket-location",
      "inputs": [58, { "value": "TraceSocket" }],
      "outputs": [56]
    },
    {
      "type": "get-socket-location",
      "inputs": [58, { "value": "EndTraceSocket" }],
      "outputs": [57]
    },
    {
      "type": "GET_VAR",
      "variable": "Mesh",
      "outputs": [58]
    },
    {
      "type": "if",
      "inputs": [55],
      "outputs": [59, 60]
    },
    {
      "type": "call",
      "comment": "We are still near AiMain_Pawn - lets Check Again",
      "func": "custom-tick",
      "inputs": [{"value": "self"}],
      "outputs": [1002]
    },
    {
      "type": "set!",
      "comment": "We can move to Target Again",
      "variable": "DroneState",
      "inputs": [60, {"value": "MoveToPlayer"}],
      "outputs": [61]
    },
    {
      "type": "sequence",
      "comment": "Reset DoOnece - so it can fire again",
      "inputs": [61],
      "outputs": [62, 63, 64, 65]
    },
    {
      "type": "call",
      "comment": "And CheckAgain",
      "func": "custom-tick",
      "inputs": [65, {"value":"self"}],
      "outputs": [1003]
    }
  ]
}
